# NICU_Processing

## Pipeline Developed for preprocessing of Neonatal Datasets

Library of associated scripts to generate windowed datasets of Cooled vs. Non-Cooled Neonatal subject data along with codebase of preprocessing pipeline to clean resulting datasets and generate features.

## Processing Pathway
	 Library of Matlab script files provide methods to perform various functions required when working with NICU datasets such as:
		1. Obtaining metadata from .EDF recording files and renaming files with associated recording details: subject-id_date_start-time
		2. Various pathways of cleaning data for different types: cooling, rewarming, followup, non-cooling
		3. Identify and convert flatline periods of recordings to NaNs
		4. Feature Generation from final preprocessed datasets

## Preprocessing Steps
	Stage 1
		- Filtering (Highpass, Lowpass)
		- Resampling
		- Bipolar Transverse Montage Rereferencing
		- Split initial Binned files into further, smaller segments 
			(Example: 8 Hour -> 4 2 Hr segmented datasets)
	Stage 2
		-Channel Rejection
			- Kurtosis
		-Generate Epochs
	Stage 3
		- Further Cleaning via Two Methods
			1. Artifact Blocking Algorithm
				a. High Amplitude Suppression based upon threshold generated by input data
			2. OToole Neural qEEG Toolbox 
				a. Artefact removal
					i. High Amplitude based upon threshold generated by input data
					ii. Voltage Jump bsed upon user-defined threshold
					iii. Constant Value based upon user-defined length
	Feature Generation
		-Band-specific feature set
			1. Univariate absolute band power averaged over channels
			2. Bivariate connectivity - debiased phase lag index averaged over connections (Global dwpli: Haartsen 2019 and Haartsen 2020)
		-Channel-specific Dynamic/complexity feature set
			1.Median frequency in power spectrum
			2.Higuchi fractal dimension
			3.Spectral entropy and flatness 		
					

## Software Utilized
- MATLAB 
	- R2018a and above
- EEGLAB 
	- 2021.1
		- Can be obtained via download at https://sccn.ucsd.edu/eeglab/download.php or cloned from https://github.com/sccn/eeglab repository

## References

### Artifact Blocking

•Fujioka, Takako, et al. “Comparison of Artifact Correction Methods for Infant EEG Applied to Extraction of Event-Related Potential Signals.” Clinical Neurophysiology, vol. 122, no. 1, 2011, pp. 43–51., https://doi.org/10.1016/j.clinph.2010.04.036

	•[https://www.sciencedirect.com/science/article/pii/S1388245710004840](https://www.sciencedirect.com/science/article/pii/S1388245710004840)

•Source: Mourad, N., et al. “A Simple and Fast Algorithm for Automatic Suppression of High-Amplitude Artifacts in EEG Data.” 2007 IEEE International Conference on Acoustics, Speech and Signal Processing - ICASSP '07, 2007, https://doi.org/10.1109/icassp.2007.366699
	
	•[A Simple and Fast Algorithm for Automatic Suppression of High-Amplitude Artifacts in EEG Data | IEEE Conference Publication | IEEE Xplore](https://ieeexplore.ieee.org/abstract/document/4217099)

### Neural qEEG Toolbox
•O'Toole, John M., and Geraldine B. Boylan. “Quantitative Preterm EEG Analysis: The Need for Caution in Using Modern Data Science Techniques.” Frontiers in Pediatrics, vol. 7, 2019, https://doi.org/10.3389/fped.2019.00174.

	•[https://www.frontiersin.org/articles/10.3389/fped.2019.00174/full](https://www.frontiersin.org/articles/10.3389/fped.2019.00174/full)


O’Toole, John M., et al. “Temporal Evolution of Quantitative EEG within 3 Days of Birth in Early Preterm Infants.” Scientific Reports, vol. 9, no. 1, 2019, https://doi.org/10.1038/s41598-019-41227-9

	•[https://www.nature.com/articles/s41598-019-41227-9](https://www.nature.com/articles/s41598-019-41227-9)
	•[https://github.com/otoolej/qEEG_feature_set](https://github.com/otoolej/qEEG_feature_set)

